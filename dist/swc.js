!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.SWC=t():e.SWC=t()}(this,(()=>(()=>{"use strict";var e={d:(t,o)=>{for(var n in o)e.o(o,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:o[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};return(()=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=Array(t);o<t;o++)n[o]=e[o];return n}function o(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,n(r.key),r)}}function n(t){var o=function(t){if("object"!=e(t)||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=e(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(o)?o:o+""}var r=function(){return e=function e(t){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.knowledgeBase=t,this.currentNode=null,this.chatHistory=[],this.botMetadata={botName:o.botName||"Bot",themeColor:o.themeColor||"#007bff",timestamp:(new Date).toISOString()}},n=[{key:"init",value:function(){this.currentNode=this.knowledgeBase.find((function(e){return"welcome"===e.id}))||this.knowledgeBase[0];var e={reply:this.currentNode.reply,options:this.currentNode.options};return this.addToHistory("bot",this.currentNode.reply,this.currentNode.id,this.currentNode.options),e}},{key:"addToHistory",value:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r={id:"msg-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),timestamp:(new Date).toISOString(),type:e,content:t};"bot"===e&&(r.nodeId=o,n&&n.length>0&&(r.options=n)),this.chatHistory.push(r)}},{key:"handleInput",value:function(e){var o=this,n=e.toLowerCase().split(/\s+/);this.addToHistory("user",e);var r={};this.knowledgeBase.forEach((function(e){r[e.id]=0,e.keyword.forEach((function(t){var o=t.toLowerCase();n.forEach((function(t){(t.includes(o)||o.includes(t))&&r[e.id]++}))}))}));var i=null,a=0;if(Object.entries(r).forEach((function(e){var n=function(e,o){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var n,r,i,a,s=[],l=!0,c=!1;try{if(i=(o=o.call(e)).next,0===t){if(Object(o)!==o)return;l=!1}else for(;!(l=(n=i.call(o)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){c=!0,r=e}finally{try{if(!l&&null!=o.return&&(a=o.return(),Object(a)!==a))return}finally{if(c)throw r}}return s}}(e,o)||function(e,o){if(e){if("string"==typeof e)return t(e,o);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?t(e,o):void 0}}(e,o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e,2),r=n[0],s=n[1];s>a&&(a=s,i=o.knowledgeBase.find((function(e){return e.id===r})))})),i)return this.currentNode=i,this.addToHistory("bot",i.reply,i.id,i.options),{reply:i.reply,options:i.options};var s="I'm sorry, I didn't understand that. Can you please rephrase?";return this.addToHistory("bot",s,null,null),{reply:s,options:null}}},{key:"handleOptionSelection",value:function(e){var t=this.knowledgeBase.find((function(t){return t.id===e}));if(t)return this.currentNode=t,this.addToHistory("bot",t.reply,t.id,t.options),{reply:t.reply,options:t.options};var o="I'm sorry, I couldn't find the appropriate response. How else can I assist you?";return this.addToHistory("bot",o,null,null),{reply:o,options:null}}},{key:"exportHistory",value:function(){var e={version:"1.0",timestamp:(new Date).toISOString(),botName:this.botMetadata.botName,themeColor:this.botMetadata.themeColor,messages:this.chatHistory,currentNodeId:this.currentNode?this.currentNode.id:null};return JSON.stringify(e,null,2)}},{key:"getCurrentState",value:function(){return{currentNodeId:this.currentNode?this.currentNode.id:null,messageCount:this.chatHistory.length,lastMessageTimestamp:this.chatHistory.length>0?this.chatHistory[this.chatHistory.length-1].timestamp:null}}},{key:"loadHistory",value:function(e){try{var t="string"==typeof e?JSON.parse(e):e;if(!t.version||!t.messages||!Array.isArray(t.messages))throw new Error("Invalid history format: missing required fields");if("1.0"!==t.version&&console.warn("History version ".concat(t.version," may not be fully compatible")),t.botName&&(this.botMetadata.botName=t.botName),t.themeColor&&(this.botMetadata.themeColor=t.themeColor),this.chatHistory=t.messages,t.currentNodeId){var o=this.knowledgeBase.find((function(e){return e.id===t.currentNodeId}));o&&(this.currentNode=o)}return{success:!0,messageCount:this.chatHistory.length,messages:this.chatHistory}}catch(e){return console.error("Error loading history:",e),{success:!1,error:e.message,messages:[]}}}},{key:"clearHistory",value:function(){return this.chatHistory=[],this.currentNode=this.knowledgeBase.find((function(e){return"welcome"===e.id}))||this.knowledgeBase[0],this.currentNode&&this.addToHistory("bot",this.currentNode.reply,this.currentNode.id,this.currentNode.options),{reply:this.currentNode?this.currentNode.reply:"",options:this.currentNode?this.currentNode.options:null}}},{key:"getHistory",value:function(){return{version:"1.0",timestamp:(new Date).toISOString(),botName:this.botMetadata.botName,themeColor:this.botMetadata.themeColor,messages:this.chatHistory,currentNodeId:this.currentNode?this.currentNode.id:null}}}],n&&o(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n}(),i=[{id:"welcome",keyword:["hello","hi","hey"],reply:'Welcome! How can I assist you <b>today?</b> <a href="https://senangwebs.com">senangwebs.com</a>',options:[{label:"Get Help",reply_id:"help"},{label:"End Chat",reply_id:"goodbye"}]},{id:"help",keyword:["help","support","assist"],reply:"Sure, I can help! What do you need assistance with?",options:[{label:"Product Information",reply_id:"product"},{label:"Billing",reply_id:"billing"},{label:"Technical Support",reply_id:"tech_support"}]},{id:"product",keyword:["product","information"],reply:"Our product is designed to make your life easier. Would you like to know more about its features or pricing?",options:[{label:"Features",reply_id:"features"},{label:"Pricing",reply_id:"pricing"}]},{id:"billing",keyword:["billing","payment","invoice"],reply:"For billing inquiries, please visit our billing portal or contact our finance department at billing@example.com.",options:[{label:"Back to Help",reply_id:"help"},{label:"End Chat",reply_id:"goodbye"}]},{id:"tech_support",keyword:["technical","support","issue"],reply:"For technical support, please describe your issue in detail and well do our best to assist you."},{id:"features",keyword:["features","functionality"],reply:"Our product offers cutting-edge features including AI-powered analytics, real-time collaboration, and seamless integration with popular tools.",options:[{label:"Back to Product Info",reply_id:"product"},{label:"End Chat",reply_id:"goodbye"}]},{id:"pricing",keyword:["pricing","cost","plans"],reply:"We offer flexible pricing plans starting at $9.99/month. For detailed pricing information, please visit our website or contact our sales team.",options:[{label:"Back to Product Info",reply_id:"product"},{label:"End Chat",reply_id:"goodbye"}]},{id:"goodbye",keyword:["bye","goodbye","end"],reply:"Thank you for chatting with us. Have a great day!",options:[{label:"Restart Chat",reply_id:"welcome"}]}];function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;document.querySelectorAll("[data-swc]").forEach((function(t){var o=t.getAttribute("data-swc-theme-color")||"#007bff",n=t.getAttribute("data-swc-bot-name")||"Bot",a=t.getAttribute("data-swc-chat-display")||"classic",s=parseInt(t.getAttribute("data-swc-reply-duration"))||0,l=t.getAttribute("data-swc-load"),c=new r(e||i,{botName:n,themeColor:o});t.chatbotInstance=c;var d=function(e,t,o,n){var r=document.createElement("div");r.className="swc-chat-display ".concat("modern"===n?"swc-modern":"swc-classic");var i=document.createElement("div");i.className="swc-input-container";var a=document.createElement("input");a.type="text",a.className="swc-user-input",a.placeholder="Type your message...";var s=document.createElement("button");s.className="swc-send-button",s.textContent="Send";var l=document.createElement("div");l.className="swc-options-container",i.appendChild(a),i.appendChild(s);var c=document.createElement("div");return c.className="swc-typing-indicator",c.innerHTML="<span></span><span></span><span></span>",e.appendChild(r),e.appendChild(l),e.appendChild(i),e.style.setProperty("--swc-theme-color",t),e.style.setProperty("--swc-bot-name",'"'.concat(o,'"')),{chatDisplay:r,userInput:a,sendButton:s,optionsContainer:l,typingIndicator:c}}(t,o,n,a),u=d.chatDisplay,p=d.userInput,y=d.sendButton,h=d.optionsContainer,m=d.typingIndicator;function f(){u.innerHTML="",h.innerHTML="",h.style.display="none"}function b(e,t){H();var o=document.createElement("div");o.className="swc-message swc-bot-message",o.innerHTML="".concat(e),u.appendChild(o),S(u),h.innerHTML="",t&&t.length>0?(h.style.display="flex",t.forEach((function(e){var t=document.createElement("button");t.textContent=e.label,t.onclick=function(){return v(e.reply_id)},h.appendChild(t)}))):h.style.display="none"}function g(){var e=p.value.trim();if(e){var t=document.createElement("div");t.className="swc-message swc-user-message",t.innerHTML="".concat(e),u.appendChild(t),S(u),p.value="",w(),C(),setTimeout((function(){var t=c.handleInput(e);b(t.reply,t.options),N()}),s)}}function v(e){w(),C(),setTimeout((function(){var t=c.handleOptionSelection(e);b(t.reply,t.options),N()}),s)}function w(){p.disabled=!0,y.disabled=!0}function N(){p.disabled=!1,y.disabled=!1}function C(){H(),u.appendChild(m),S(u)}function H(){m.parentNode===u&&u.removeChild(m)}function S(e){var t=e.scrollHeight-e.clientHeight,o=e.scrollTop,n=t-o,r=null;window.requestAnimationFrame((function t(i){r||(r=i);var a,s,l,c=i-r;e.scrollTop=(a=c,s=o,l=n,(a/=150)<1?l/2*a*a*a+s:l/2*((a-=2)*a*a+2)+s),c<300&&window.requestAnimationFrame(t)}))}y.addEventListener("click",g),p.addEventListener("keypress",(function(e){"Enter"===e.key&&g()}));var k=c.clearHistory.bind(c);c.clearHistory=function(){var e=k();return f(),b(e.reply,e.options),t.dispatchEvent(new CustomEvent("swc:history-cleared",{detail:{timestamp:(new Date).toISOString()}})),e};var E=c.exportHistory.bind(c);c.exportHistory=function(){var e=E();return t.dispatchEvent(new CustomEvent("swc:history-exported",{detail:{messageCount:c.chatHistory.length,historyJSON:e,timestamp:(new Date).toISOString()}})),e};var I=c.loadHistory.bind(c);if(c.loadHistory=function(e){var o=I(e);if(o.success){if(f(),o.messages.forEach((function(e){var t,o;t=e,(o=document.createElement("div")).className="swc-message swc-".concat(t.type,"-message"),o.innerHTML=t.content,u.appendChild(o)})),o.messages.length>0){var n=o.messages[o.messages.length-1];n.options&&n.options.length>0&&(h.style.display="flex",n.options.forEach((function(e){var t=document.createElement("button");t.textContent=e.label,t.onclick=function(){return v(e.reply_id)},h.appendChild(t)})))}S(u),t.dispatchEvent(new CustomEvent("swc:history-loaded",{detail:{messageCount:o.messageCount,timestamp:(new Date).toISOString()}}))}else console.error("Failed to load history:",o.error);return o},l)if(l.startsWith("http://")||l.startsWith("https://")||l.startsWith("./")||l.startsWith("../")||l.endsWith(".json"))fetch(l).then((function(e){if(!e.ok)throw new Error("HTTP error! status: ".concat(e.status));return e.json()})).then((function(e){c.loadHistory(e)})).catch((function(e){console.error("Error loading history from file:",e);var t=c.init();b(t.reply,t.options)}));else try{var T=JSON.parse(l);c.loadHistory(T)}catch(e){console.error("Error parsing inline history JSON:",e);var O=c.init();b(O.reply,O.options)}else{var M=c.init();b(M.reply,M.options)}}))}"undefined"!=typeof window&&(window.initializeChatbot=a,"loading"===document.readyState?document.addEventListener("DOMContentLoaded",(function(){a()})):a())})(),e.r(t),t})()));